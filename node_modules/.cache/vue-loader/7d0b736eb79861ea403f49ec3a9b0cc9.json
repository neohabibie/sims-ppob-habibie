{"remainingRequest":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Payment.vue?vue&type=style&index=0&id=322f15bc&scoped=true&lang=css","dependencies":[{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Payment.vue","mtime":1757768534762},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\css-loader\\dist\\cjs.js","mtime":1757611685071},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1757611687083},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\postcss-loader\\src\\index.js","mtime":1757611685430},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1757611684910},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js","mtime":1757611686384}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5zYWxkby1jYXJkIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJy4uL2Fzc2V0cy9CYWNrZ3JvdW5kX1NhbGRvLnBuZycpOwogIGJvcmRlci1yYWRpdXM6IDE2cHg7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiByaWdodDsKICBtaW4taGVpZ2h0OiAxMjBweDsKfQouYXZhdGFyLWxnIHsKICB3aWR0aDogNjBweDsKICBoZWlnaHQ6IDYwcHg7CiAgYm9yZGVyLXJhZGl1czogNTAlOwp9Ci5wYXltZW50LWNhcmQgewogIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgcGFkZGluZzogMjBweDsKfQouYnRuLWJheWFyIHsKICBiYWNrZ3JvdW5kOiAjZjQ0MzM2OwogIGJvcmRlcjogbm9uZTsKICBmb250LXdlaWdodDogYm9sZDsKfQouYnRuLWJheWFyOmhvdmVyIHsKICBiYWNrZ3JvdW5kOiAjZDMyZjJmOwp9Cg=="},{"version":3,"sources":["Payment.vue"],"names":[],"mappings":";AAoLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Payment.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-container>\r\n\r\n    <b-row class=\"mb-4\">\r\n      <b-col cols=\"12\" md=\"8\">\r\n        <div class=\"d-flex align-items-center\">\r\n          <img :src=\"userImage\" class=\"avatar-lg mr-3\" />\r\n          <div>\r\n            <h5 class=\"mb-1\">Selamat datang,</h5>\r\n            <h3 class=\"font-weight-bold\">{{ profile.first_name }} {{ profile.last_name }}</h3>\r\n          </div>\r\n        </div>\r\n      </b-col>\r\n\r\n      <b-col cols=\"12\" md=\"4\">\r\n        <b-card class=\"saldo-card text-white p-3 d-flex flex-column justify-content-between\">\r\n          <div>\r\n            <small>Saldo anda</small>\r\n            <h3 class=\"mb-0\">{{ showBalance ? balanceDisplay : 'Rp ••••••••' }}</h3>\r\n          </div>\r\n          <b-link class=\"text-white mt-2\" href=\"#\" @click.prevent=\"toggleBalance\">\r\n            {{ showBalance ? 'Sembunyikan' : 'Lihat Saldo' }}\r\n            <i :class=\"showBalance ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n          </b-link>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n\r\n    <b-card class=\"payment-card\">\r\n      <div v-if=\"service\">\r\n        <p class=\"mb-2 font-weight-bold\">Pembayaran</p>\r\n        <div class=\"d-flex align-items-center mb-3\">\r\n          <b-avatar :src=\"service.service_icon\" class=\"mr-2\"></b-avatar>\r\n          <strong>{{ service.service_name }}</strong>\r\n        </div>\r\n\r\n        <b-input-group class=\"mb-3\">\r\n          <b-input-group-prepend is-text>\r\n            <i class=\"fa-solid fa-money-bill-transfer\"></i>\r\n          </b-input-group-prepend>\r\n\r\n          <b-form-input v-model=\"amount\" placeholder=\"Masukkan nominal\" type=\"number\" />\r\n        </b-input-group>\r\n\r\n        <b-button block class=\"btn-bayar\" size=\"lg\" @click=\"doPayment\">\r\n          Bayar\r\n        </b-button>\r\n      </div>\r\n\r\n      <div v-else>\r\n        <p>Service belum dipilih. Kembali ke Home untuk memilih layanan.</p>\r\n        <b-button @click=\"$router.push('/home')\">Kembali ke Home</b-button>\r\n      </div>\r\n    </b-card>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport api from '../services/api';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      profile: {},\r\n      balance: 0,\r\n      showBalance: true,\r\n      service: null,\r\n      amount: null,\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    userImage() {\r\n      return this.profile.profile_image\r\n        ? this.profile.profile_image\r\n        : require('../assets/default-avatar.png')\r\n    },\r\n    balanceDisplay() {\r\n      return new Intl.NumberFormat('id-ID', {\r\n        style: 'currency',\r\n        currency: 'IDR'\r\n      }).format(this.balance || 0)\r\n    }\r\n  },\r\n\r\n  async created() {\r\n    const sid = this.$route.query.service_code;\r\n    try {\r\n      const [p, b] = await Promise.all([\r\n        api.get('/profile'),\r\n        api.get('/balance')\r\n      ]);\r\n      this.profile = p.data.data || {};\r\n      this.balance = (b.data && b.data.data.balance) ? b.data.data.balance : 0;\r\n\r\n      if (sid) {\r\n        const res = await api.get('/services');\r\n        const services = Array.isArray(res.data.data) ? res.data.data : [];\r\n        this.service = services.find(s => String(s.service_code) === String(sid));\r\n        this.amount = this.service.service_tariff;\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    toggleBalance() {\r\n      this.showBalance = !this.showBalance;\r\n    },\r\n\r\n    async doPayment() {\r\n      if (!this.service || !this.amount) {\r\n        this.$bvToast.toast('Masukkan nominal terlebih dahulu', {\r\n          title: 'Error',\r\n          variant: 'danger',\r\n          autoHideDelay: 3000\r\n        });\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const res = await api.post('/transaction', {\r\n          service_code: this.service.service_code,\r\n          amount: this.amount\r\n        });\r\n\r\n        if (res.data && res.data.success) {\r\n          this.$bvToast.toast('Pembayaran sukses', {\r\n            title: 'Sukses',\r\n            variant: 'success',\r\n            autoHideDelay: 2000\r\n          });\r\n          setTimeout(() => this.$router.push(\"/history\"), 2000);\r\n        } else {\r\n          this.$bvToast.toast(res.data.message || 'Gagal bayar', {\r\n            title: 'Error',\r\n            variant: 'danger',\r\n            autoHideDelay: 3000\r\n          });\r\n        }\r\n      } catch (e) {\r\n        this.$bvToast.toast('Error saat pembayaran', {\r\n          title: 'Error',\r\n          variant: 'danger',\r\n          autoHideDelay: 3000\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .saldo-card {\r\n    background-image: url('../assets/Background_Saldo.png');\r\n    border-radius: 16px;\r\n    background-repeat: no-repeat;\r\n    background-position: right;\r\n    min-height: 120px;\r\n  }\r\n  .avatar-lg {\r\n    width: 60px;\r\n    height: 60px;\r\n    border-radius: 50%;\r\n  }\r\n  .payment-card {\r\n    border-radius: 12px;\r\n    padding: 20px;\r\n  }\r\n  .btn-bayar {\r\n    background: #f44336;\r\n    border: none;\r\n    font-weight: bold;\r\n  }\r\n  .btn-bayar:hover {\r\n    background: #d32f2f;\r\n  }\r\n</style>\r\n"]}]}