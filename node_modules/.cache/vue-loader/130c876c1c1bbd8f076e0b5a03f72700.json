{"remainingRequest":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\History.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\History.vue","mtime":1757768174980},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1757611684910},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js","mtime":1757611686384}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgYXBpIGZyb20gJy4uL3NlcnZpY2VzL2FwaSc7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRyYW5zYWN0aW9uczogW10sDQogICAgICBsaW1pdDogNSwNCiAgICAgIG9mZnNldDogMCwNCiAgICAgIGFsbExvYWRlZDogZmFsc2UsDQogICAgICBwcm9maWxlOiB7fSwNCiAgICAgIGJhbGFuY2U6IDAsDQogICAgICBzaG93QmFsYW5jZTogdHJ1ZSwNCiAgICB9DQogIH0sDQoNCiAgY29tcHV0ZWQ6IHsNCiAgICB1c2VySW1hZ2UoKSB7DQogICAgICByZXR1cm4gdGhpcy5wcm9maWxlLnByb2ZpbGVfaW1hZ2UNCiAgICAgICAgPyB0aGlzLnByb2ZpbGUucHJvZmlsZV9pbWFnZQ0KICAgICAgICA6IHJlcXVpcmUoJy4uL2Fzc2V0cy9kZWZhdWx0LWF2YXRhci5wbmcnKQ0KICAgIH0sDQogICAgDQogICAgYmFsYW5jZURpc3BsYXkoKSB7DQogICAgICByZXR1cm4gbmV3IEludGwuTnVtYmVyRm9ybWF0KCdpZC1JRCcsIHsNCiAgICAgICAgc3R5bGU6ICdjdXJyZW5jeScsDQogICAgICAgIGN1cnJlbmN5OiAnSURSJw0KICAgICAgfSkuZm9ybWF0KHRoaXMuYmFsYW5jZSB8fCAwKQ0KICAgIH0NCiAgfSwNCg0KICBhc3luYyBjcmVhdGVkKCkgew0KICAgIGF3YWl0IHRoaXMubG9hZCgpOw0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBsb2FkKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgW3AsIGJdID0gYXdhaXQgUHJvbWlzZS5hbGwoWw0KICAgICAgICAgIGFwaS5nZXQoJy9wcm9maWxlJyksDQogICAgICAgICAgYXBpLmdldCgnL2JhbGFuY2UnKSwNCiAgICAgICAgXSk7DQogICAgICAgIHRoaXMucHJvZmlsZSA9IHAuZGF0YS5kYXRhIHx8IHt9DQogICAgICAgIHRoaXMuYmFsYW5jZSA9IChiLmRhdGEgJiYgYi5kYXRhLmRhdGEuYmFsYW5jZSkgPyBiLmRhdGEuZGF0YS5iYWxhbmNlIDogMA0KDQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5nZXQoJy90cmFuc2FjdGlvbi9oaXN0b3J5Jywgew0KICAgICAgICAgIHBhcmFtczogew0KICAgICAgICAgICAgbGltaXQ6IHRoaXMubGltaXQsDQogICAgICAgICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgY29uc3QgaXRlbXMgPSAocmVzLmRhdGEgJiYgcmVzLmRhdGEuZGF0YS5yZWNvcmRzKSA/IHJlcy5kYXRhLmRhdGEucmVjb3JkcyA6IFtdOw0KICAgICAgICB0aGlzLnRyYW5zYWN0aW9ucy5wdXNoKC4uLml0ZW1zKTsNCiAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA8IHRoaXMubGltaXQpIHRoaXMuYWxsTG9hZGVkID0gdHJ1ZTsNCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcihlKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgdG9nZ2xlQmFsYW5jZSgpIHsNCiAgICAgIHRoaXMuc2hvd0JhbGFuY2UgPSAhdGhpcy5zaG93QmFsYW5jZTsNCiAgICB9LA0KDQogICAgc2hvd01vcmUoKSB7DQogICAgICB0aGlzLm9mZnNldCArPSB0aGlzLmxpbWl0Ow0KICAgICAgdGhpcy5sb2FkKCk7DQogICAgfSwNCg0KICAgIGZvcm1hdERhdGUoZGF0ZXMpIHsNCiAgICAgIHJldHVybiBkYXRlcyA/IG5ldyBEYXRlKGRhdGVzKS50b0xvY2FsZVN0cmluZygnaWQtSUQnKTogJy0nOw0KICAgIH0sDQogICAgDQogICAgZm9ybWF0QW1vdW50KGEpIHsNCiAgICAgIHJldHVybiBuZXcgSW50bC5OdW1iZXJGb3JtYXQoJ2lkLUlEJywgew0KICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JywNCiAgICAgICAgY3VycmVuY3k6ICdJRFInDQogICAgICB9KS5mb3JtYXQoYSB8fCAwKTsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["History.vue"],"names":[],"mappings":";AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"History.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-container>\r\n    <b-row class=\"mb-4\">\r\n      <b-col cols=\"12\" md=\"8\">\r\n        <div class=\"d-flex align-items-center\">\r\n          <img :src=\"userImage\" class=\"avatar-lg mr-3\" />\r\n          <div>\r\n            <h5 class=\"mb-1\">Selamat datang,</h5>\r\n            <h3 class=\"font-weight-bold\">{{ profile.first_name }} {{ profile.last_name }}</h3>\r\n          </div>\r\n        </div>\r\n      </b-col>\r\n\r\n      <b-col cols=\"12\" md=\"4\">\r\n        <b-card class=\"saldo-card text-white p-3 d-flex flex-column justify-content-between\">\r\n          <div>\r\n            <small>Saldo anda</small>\r\n            <h3 class=\"mb-0\">{{ showBalance ? balanceDisplay : 'Rp ••••••••' }}</h3>\r\n          </div>\r\n          <b-link class=\"text-white mt-2\" href=\"#\" @click.prevent=\"toggleBalance\">\r\n            {{ showBalance ? 'Sembunyikan' : 'Lihat Saldo' }}\r\n            <i :class=\"showBalance ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n          </b-link>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n\r\n    <b-row class=\"justify-content-center\">\r\n      <b-col cols=\"12\" md=\"8\">\r\n        <h5 class=\"mb-3 font-weight-bold\">Semua Transaksi</h5>\r\n\r\n        <div v-if=\"transactions.length\">\r\n          <b-list-group>\r\n            <b-list-group-item v-for=\"t in transactions\" :key=\"t.id\" class=\"d-flex justify-content-between align-items-center\">\r\n              <div>\r\n                <div :class=\"t.transaction_type === 'TOPUP' ? 'text-success font-weight-bold' : 'text-danger font-weight-bold'\">\r\n                  {{ t.transaction_type === 'TOPUP' ? '+ ' : '- ' }}{{ formatAmount(t.total_amount) }}\r\n                </div>\r\n                <small class=\"text-muted\">{{ formatDate(t.created_on) }}</small>\r\n              </div>\r\n\r\n              <div class=\"text-muted small\">\r\n                {{ t.description || t.transaction_type || 'Transaksi' }}\r\n              </div>\r\n            </b-list-group-item>\r\n          </b-list-group>\r\n        </div>\r\n\r\n        <div v-else class=\"text-center py-4 text-muted\">Belum ada transaksi</div>\r\n\r\n        <!-- Show more -->\r\n        <div class=\"text-center mt-3\">\r\n          <b-link v-if=\"!allLoaded\" href=\"#\" class=\"text-danger\" @click.prevent=\"showMore\">\r\n            Show more\r\n          </b-link>\r\n        </div>\r\n      </b-col>\r\n    </b-row>\r\n  <b-container>\r\n</template>\r\n\r\n<script>\r\nimport api from '../services/api';\r\nexport default {\r\n  data() {\r\n    return {\r\n      transactions: [],\r\n      limit: 5,\r\n      offset: 0,\r\n      allLoaded: false,\r\n      profile: {},\r\n      balance: 0,\r\n      showBalance: true,\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    userImage() {\r\n      return this.profile.profile_image\r\n        ? this.profile.profile_image\r\n        : require('../assets/default-avatar.png')\r\n    },\r\n    \r\n    balanceDisplay() {\r\n      return new Intl.NumberFormat('id-ID', {\r\n        style: 'currency',\r\n        currency: 'IDR'\r\n      }).format(this.balance || 0)\r\n    }\r\n  },\r\n\r\n  async created() {\r\n    await this.load();\r\n  },\r\n\r\n  methods: {\r\n    async load() {\r\n      try {\r\n        const [p, b] = await Promise.all([\r\n          api.get('/profile'),\r\n          api.get('/balance'),\r\n        ]);\r\n        this.profile = p.data.data || {}\r\n        this.balance = (b.data && b.data.data.balance) ? b.data.data.balance : 0\r\n\r\n        const res = await api.get('/transaction/history', {\r\n          params: {\r\n            limit: this.limit,\r\n            offset: this.offset\r\n          }\r\n        });\r\n        const items = (res.data && res.data.data.records) ? res.data.data.records : [];\r\n        this.transactions.push(...items);\r\n        if (items.length < this.limit) this.allLoaded = true;\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    },\r\n\r\n    toggleBalance() {\r\n      this.showBalance = !this.showBalance;\r\n    },\r\n\r\n    showMore() {\r\n      this.offset += this.limit;\r\n      this.load();\r\n    },\r\n\r\n    formatDate(dates) {\r\n      return dates ? new Date(dates).toLocaleString('id-ID'): '-';\r\n    },\r\n    \r\n    formatAmount(a) {\r\n      return new Intl.NumberFormat('id-ID', {\r\n        style: 'currency',\r\n        currency: 'IDR'\r\n      }).format(a || 0);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .saldo-card {\r\n    background-image: url('../assets/Background_Saldo.png');\r\n    border-radius: 16px;\r\n    background-repeat: no-repeat;\r\n    background-position: right;\r\n    min-height: 120px;\r\n  }\r\n  .avatar-lg {\r\n    width: 60px;\r\n    height: 60px;\r\n    border-radius: 50%;\r\n  }\r\n</style>\r\n"]}]}