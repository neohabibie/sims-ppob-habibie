{"remainingRequest":"C:\\xampp\\htdocs\\sims-ppob-habibie\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\sims-ppob-habibie\\src\\views\\TopUp.vue?vue&type=style&index=0&id=4932a906&scoped=true&lang=css","dependencies":[{"path":"C:\\xampp\\htdocs\\sims-ppob-habibie\\src\\views\\TopUp.vue","mtime":1757768144041},{"path":"C:\\xampp\\htdocs\\sims-ppob-habibie\\node_modules\\css-loader\\dist\\cjs.js","mtime":1757611685071},{"path":"C:\\xampp\\htdocs\\sims-ppob-habibie\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1757611687083},{"path":"C:\\xampp\\htdocs\\sims-ppob-habibie\\node_modules\\postcss-loader\\src\\index.js","mtime":1757611685430},{"path":"C:\\xampp\\htdocs\\sims-ppob-habibie\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1757611684910},{"path":"C:\\xampp\\htdocs\\sims-ppob-habibie\\node_modules\\vue-loader\\lib\\index.js","mtime":1757611686384}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5zYWxkby1jYXJkIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJy4uL2Fzc2V0cy9CYWNrZ3JvdW5kX1NhbGRvLnBuZycpOwogIGJvcmRlci1yYWRpdXM6IDE2cHg7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgbWluLWhlaWdodDogMTIwcHg7Cn0KLmF2YXRhci1sZyB7CiAgd2lkdGg6IDYwcHg7CiAgaGVpZ2h0OiA2MHB4OwogIGJvcmRlci1yYWRpdXM6IDUwJTsKfQo="},{"version":3,"sources":["TopUp.vue"],"names":[],"mappings":";AA2LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TopUp.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-container>\r\n    <b-row class=\"mb-4\">\r\n      <b-col cols=\"12\" md=\"8\">\r\n        <div class=\"d-flex align-items-center\">\r\n          <img :src=\"userImage\" class=\"avatar-lg mr-3\" />\r\n          <div>\r\n            <h5 class=\"mb-1\">Selamat datang,</h5>\r\n            <h3 class=\"font-weight-bold\">{{ profile.first_name }} {{ profile.last_name }}</h3>\r\n          </div>\r\n        </div>\r\n      </b-col>\r\n\r\n      <b-col cols=\"12\" md=\"4\">\r\n        <b-card class=\"saldo-card text-white p-3 d-flex flex-column justify-content-between\">\r\n          <div>\r\n            <small>Saldo anda</small>\r\n            <h3 class=\"mb-0\">{{ showBalance ? balanceDisplay : 'Rp ••••••••' }}</h3>\r\n          </div>\r\n          <b-link class=\"text-white mt-2\" href=\"#\" @click.prevent=\"toggleBalance\">\r\n            {{ showBalance ? 'Sembunyikan' : 'Lihat Saldo' }}\r\n            <i :class=\"showBalance ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n          </b-link>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n\r\n    <b-row class=\"justify-content-center\">\r\n      <b-col cols=\"12\" md=\"8\">\r\n        <h5 class=\"mb-3\">Silahkan masukan</h5>\r\n        <h3 class=\"mb-4 font-weight-bold\">Nominal Top Up</h3>\r\n\r\n        <b-input-group class=\"mb-3\">\r\n          <b-input-group-prepend is-text>\r\n            <i class=\"fa-solid fa-money-bill-transfer\"></i>\r\n          </b-input-group-prepend>\r\n\r\n          <b-form-input v-model=\"nominal\" type=\"number\" placeholder=\"10.000\"/>\r\n        </b-input-group>\r\n\r\n        <div class=\"d-flex flex-wrap mb-3\">\r\n          <b-button v-for=\"p in presets\" :key=\"p\" class=\"mr-2 mb-2\" variant=\"outline-secondary\" @click=\"setPreset(p)\">\r\n            {{ format(p) }}\r\n          </b-button>\r\n        </div>\r\n\r\n        <b-button :disabled=\"!isValid || isLoading\" variant=\"danger\" block @click=\"submitTopUp\">\r\n          <b-spinner v-if=\"isLoading\" small type=\"border\" class=\"mr-2\"></b-spinner> Top Up\r\n        </b-button>\r\n\r\n      </b-col>\r\n    </b-row>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\n  import api from \"../services/api\";\r\n  import { amountValid } from \"../utils/validators\";\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        nominal: \"\",\r\n        presets: [10000, 20000, 50000, 100000, 250000, 500000],\r\n        isLoading: false,\r\n        profile: {},\r\n        balance: 0,\r\n        showBalance: true,\r\n      };\r\n    },\r\n\r\n    computed: {\r\n      isValid() {\r\n        return amountValid(this.nominal, 10000, 1000000);\r\n      },\r\n\r\n      userImage() {\r\n        return this.profile.profile_image\r\n          ? this.profile.profile_image\r\n          : require('../assets/default-avatar.png')\r\n      },\r\n\r\n      balanceDisplay() {\r\n        return new Intl.NumberFormat('id-ID', {\r\n          style: 'currency',\r\n          currency: 'IDR'\r\n        }).format(this.balance || 0)\r\n      }\r\n    },\r\n\r\n    async created() {\r\n      await this.loadAll()\r\n    },\r\n\r\n    methods: {\r\n      async loadAll() {\r\n        try {\r\n          const [p, b, s, bn] = await Promise.all([\r\n            api.get('/profile'),\r\n            api.get('/balance'),\r\n          ])\r\n\r\n          this.profile = p.data.data || {}\r\n          this.balance = (b.data && b.data.data.balance) ? b.data.data.balance : 0\r\n        } catch (e) {\r\n          console.error(e)\r\n        }\r\n      },\r\n\r\n      toggleBalance() {\r\n        this.showBalance = !this.showBalance;\r\n      },\r\n      \r\n      format(n) {\r\n        return new Intl.NumberFormat(\"id-ID\", {\r\n          style: \"currency\",\r\n          currency: \"IDR\",\r\n        }).format(n);\r\n      },\r\n\r\n      setPreset(n) {\r\n        this.nominal = n;\r\n      },\r\n      async submitTopUp() {\r\n        if (!this.isValid) {\r\n          return this.$bvToast.toast(\"Nominal tidak valid\", {\r\n            title: \"Error\",\r\n            variant: \"danger\",\r\n            autoHideDelay: 3000,\r\n          });\r\n        }\r\n\r\n        this.isLoading = true;\r\n        try {\r\n          const res = await api.post(\"/topup\", {\r\n            top_up_amount: Number(this.nominal),\r\n          });\r\n\r\n          if (res.data && res.data.status === 0) {\r\n            this.$bvToast.toast(res.data.message || \"Top Up berhasil\", {\r\n              title: \"Sukses\",\r\n              variant: \"success\",\r\n              autoHideDelay: 2000,\r\n            });\r\n            setTimeout(() => {\r\n              this.$router.push(\"/history\");\r\n            }, 2000);\r\n          } else {\r\n            this.$bvToast.toast(res.data.message || \"Topup gagal\", {\r\n              title: \"Error\",\r\n              variant: \"danger\",\r\n              autoHideDelay: 3000,\r\n            });\r\n          }\r\n        } catch (e) {\r\n          this.$bvToast.toast(\r\n            (e.response && e.response.data && e.response.data.message) ||\r\n              \"Error saat topup\",\r\n            {\r\n              title: \"Error\",\r\n              variant: \"danger\",\r\n              autoHideDelay: 3000,\r\n            }\r\n          );\r\n        } finally {\r\n          this.isLoading = false;\r\n        }\r\n      },\r\n    },\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  .saldo-card {\r\n    background-image: url('../assets/Background_Saldo.png');\r\n    border-radius: 16px;\r\n    background-repeat: no-repeat;\r\n    background-position: center;\r\n    min-height: 120px;\r\n  }\r\n  .avatar-lg {\r\n    width: 60px;\r\n    height: 60px;\r\n    border-radius: 50%;\r\n  }\r\n</style>\r\n"]}]}