{"remainingRequest":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Payment.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Payment.vue","mtime":1757652379383},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1757611684910},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js","mtime":1757611686384}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogIGltcG9ydCBhcGkgZnJvbSAnLi4vc2VydmljZXMvYXBpJzsNCiAgZXhwb3J0IGRlZmF1bHQgew0KICAgIGRhdGEoKSB7DQogICAgICByZXR1cm4gew0KICAgICAgICBzZXJ2aWNlOiBudWxsDQogICAgICB9Ow0KICAgIH0sDQoNCiAgICBjb21wdXRlZDogew0KICAgICAgcHJpY2VEaXNwbGF5KCkgew0KICAgICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlID8gbmV3IEludGwuTnVtYmVyRm9ybWF0KCdpZC1JRCcsIHsNCiAgICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JywNCiAgICAgICAgICBjdXJyZW5jeTogJ0lEUicNCiAgICAgICAgfSkuZm9ybWF0KHRoaXMuc2VydmljZS5wcmljZSkgOiAnJzsNCiAgICAgIH0NCiAgICB9LA0KICAgIGFzeW5jIGNyZWF0ZWQoKSB7DQogICAgICBjb25zdCBzaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5zZXJ2aWNlSWQ7DQogICAgICBpZiAoIXNpZCkgcmV0dXJuOw0KDQogICAgICB0cnkgew0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBhcGkuZ2V0KCcvc2VydmljZXMnKTsNCiAgICAgICAgLy8gY29uc3Qgc2VydmljZXMgPSByZXMuZGF0YT8uc2VydmljZXMgfHwgW107DQogICAgICAgIGNvbnN0IHNlcnZpY2VzID0gKHJlcy5kYXRhICYmIHJlcy5kYXRhLnNlcnZpY2VzKSA/IHJlcy5kYXRhLnNlcnZpY2VzIDogW107DQogICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2VzLmZpbmQocyA9PiBTdHJpbmcocy5pZCkgPT09IFN0cmluZyhzaWQpKTsNCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcihlKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgbWV0aG9kczogew0KICAgICAgYXN5bmMgZG9QYXltZW50KCkgew0KICAgICAgICBpZiAoIXRoaXMuc2VydmljZSkgcmV0dXJuOw0KDQogICAgICAgIHRyeSB7DQogICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLnBvc3QoJy90cmFuc2FjdGlvbicsIHsNCiAgICAgICAgICAgIHNlcnZpY2VJZDogdGhpcy5zZXJ2aWNlLmlkDQogICAgICAgICAgfSk7DQoNCiAgICAgICAgICBpZiAocmVzLmRhdGEgJiYgcmVzLmRhdGEuc3VjY2Vzcykgew0KICAgICAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdCgnUGVtYmF5YXJhbiBzdWtzZXMnLCB7DQogICAgICAgICAgICAgIHRpdGxlOiAnU3Vrc2VzJywNCiAgICAgICAgICAgICAgdmFyaWFudDogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgICBhdXRvSGlkZURlbGF5OjIwMDANCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvaGlzdG9yeSIpOw0KICAgICAgICAgICAgfSwgMjAwMCk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QocmVzLmRhdGEubWVzc2FnZSB8fCAnR2FnYWwgYmF5YXInLCB7DQogICAgICAgICAgICAgIHRpdGxlOiAnRXJyb3InLA0KICAgICAgICAgICAgICB2YXJpYW50OiAnZGFuZ2VyJywNCiAgICAgICAgICAgICAgYXV0b0hpZGVEZWxheTozMDAwDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IA0KDQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdFcnJvciBzYWF0IHBlbWJheWFyYW4nLCB7DQogICAgICAgICAgICB0aXRsZTogJ0Vycm9yJywNCiAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInLA0KICAgICAgICAgICAgYXV0b0hpZGVEZWxheTozMDAwDQogICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0NCg=="},{"version":3,"sources":["Payment.vue"],"names":[],"mappings":";AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Payment.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-row class=\"justify-content-center\">\r\n    <b-col cols=\"12\" md=\"6\">\r\n      <b-card class=\"card-elevated\">\r\n        <div v-if=\"service\">\r\n          <h5>Konfirmasi Pembayaran</h5>\r\n\r\n          <div class=\"mb-2\">\r\n            <strong>{{ service.name }}</strong>\r\n          </div>\r\n\r\n          <div class=\"mb-3\">\r\n            Total: <span style=\"font-weight:700\">{{ priceDisplay }}</span>\r\n          </div>\r\n          <b-button variant=\"success\" block @click=\"doPayment\">Bayar Sekarang</b-button>\r\n        </div>\r\n\r\n        <div v-else>\r\n          <p>Service belum dipilih. Kembali ke Home untuk memilih layanan.</p>\r\n          <b-button @click=\"$router.push('/home')\">Kembali ke Home</b-button>\r\n        </div>\r\n      </b-card>\r\n    </b-col>\r\n  </b-row>\r\n</template>\r\n\r\n<script>\r\n  import api from '../services/api';\r\n  export default {\r\n    data() {\r\n      return {\r\n        service: null\r\n      };\r\n    },\r\n\r\n    computed: {\r\n      priceDisplay() {\r\n        return this.service ? new Intl.NumberFormat('id-ID', {\r\n          style: 'currency',\r\n          currency: 'IDR'\r\n        }).format(this.service.price) : '';\r\n      }\r\n    },\r\n    async created() {\r\n      const sid = this.$route.query.serviceId;\r\n      if (!sid) return;\r\n\r\n      try {\r\n        const res = await api.get('/services');\r\n        // const services = res.data?.services || [];\r\n        const services = (res.data && res.data.services) ? res.data.services : [];\r\n        this.service = services.find(s => String(s.id) === String(sid));\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    },\r\n\r\n    methods: {\r\n      async doPayment() {\r\n        if (!this.service) return;\r\n\r\n        try {\r\n          const res = await api.post('/transaction', {\r\n            serviceId: this.service.id\r\n          });\r\n\r\n          if (res.data && res.data.success) {\r\n            this.$bvToast.toast('Pembayaran sukses', {\r\n              title: 'Sukses',\r\n              variant: 'success',\r\n              autoHideDelay:2000\r\n            });\r\n            setTimeout(() => {\r\n              this.$router.push(\"/history\");\r\n            }, 2000);\r\n          } else {\r\n            this.$bvToast.toast(res.data.message || 'Gagal bayar', {\r\n              title: 'Error',\r\n              variant: 'danger',\r\n              autoHideDelay:3000\r\n            });\r\n          } \r\n\r\n        } catch (e) {\r\n          this.$bvToast.toast('Error saat pembayaran', {\r\n            title: 'Error',\r\n            variant: 'danger',\r\n            autoHideDelay:3000\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>"]}]}