{"remainingRequest":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Payment.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Payment.vue","mtime":1757768534762},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1757611684910},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js","mtime":1757611686384}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgYXBpIGZyb20gJy4uL3NlcnZpY2VzL2FwaSc7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgcHJvZmlsZToge30sDQogICAgICBiYWxhbmNlOiAwLA0KICAgICAgc2hvd0JhbGFuY2U6IHRydWUsDQogICAgICBzZXJ2aWNlOiBudWxsLA0KICAgICAgYW1vdW50OiBudWxsLA0KICAgIH0NCiAgfSwNCg0KICBjb21wdXRlZDogew0KICAgIHVzZXJJbWFnZSgpIHsNCiAgICAgIHJldHVybiB0aGlzLnByb2ZpbGUucHJvZmlsZV9pbWFnZQ0KICAgICAgICA/IHRoaXMucHJvZmlsZS5wcm9maWxlX2ltYWdlDQogICAgICAgIDogcmVxdWlyZSgnLi4vYXNzZXRzL2RlZmF1bHQtYXZhdGFyLnBuZycpDQogICAgfSwNCiAgICBiYWxhbmNlRGlzcGxheSgpIHsNCiAgICAgIHJldHVybiBuZXcgSW50bC5OdW1iZXJGb3JtYXQoJ2lkLUlEJywgew0KICAgICAgICBzdHlsZTogJ2N1cnJlbmN5JywNCiAgICAgICAgY3VycmVuY3k6ICdJRFInDQogICAgICB9KS5mb3JtYXQodGhpcy5iYWxhbmNlIHx8IDApDQogICAgfQ0KICB9LA0KDQogIGFzeW5jIGNyZWF0ZWQoKSB7DQogICAgY29uc3Qgc2lkID0gdGhpcy4kcm91dGUucXVlcnkuc2VydmljZV9jb2RlOw0KICAgIHRyeSB7DQogICAgICBjb25zdCBbcCwgYl0gPSBhd2FpdCBQcm9taXNlLmFsbChbDQogICAgICAgIGFwaS5nZXQoJy9wcm9maWxlJyksDQogICAgICAgIGFwaS5nZXQoJy9iYWxhbmNlJykNCiAgICAgIF0pOw0KICAgICAgdGhpcy5wcm9maWxlID0gcC5kYXRhLmRhdGEgfHwge307DQogICAgICB0aGlzLmJhbGFuY2UgPSAoYi5kYXRhICYmIGIuZGF0YS5kYXRhLmJhbGFuY2UpID8gYi5kYXRhLmRhdGEuYmFsYW5jZSA6IDA7DQoNCiAgICAgIGlmIChzaWQpIHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLmdldCgnL3NlcnZpY2VzJyk7DQogICAgICAgIGNvbnN0IHNlcnZpY2VzID0gQXJyYXkuaXNBcnJheShyZXMuZGF0YS5kYXRhKSA/IHJlcy5kYXRhLmRhdGEgOiBbXTsNCiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZXMuZmluZChzID0+IFN0cmluZyhzLnNlcnZpY2VfY29kZSkgPT09IFN0cmluZyhzaWQpKTsNCiAgICAgICAgdGhpcy5hbW91bnQgPSB0aGlzLnNlcnZpY2Uuc2VydmljZV90YXJpZmY7DQogICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgY29uc29sZS5lcnJvcihlKTsNCiAgICB9DQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIHRvZ2dsZUJhbGFuY2UoKSB7DQogICAgICB0aGlzLnNob3dCYWxhbmNlID0gIXRoaXMuc2hvd0JhbGFuY2U7DQogICAgfSwNCg0KICAgIGFzeW5jIGRvUGF5bWVudCgpIHsNCiAgICAgIGlmICghdGhpcy5zZXJ2aWNlIHx8ICF0aGlzLmFtb3VudCkgew0KICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdNYXN1a2thbiBub21pbmFsIHRlcmxlYmloIGRhaHVsdScsIHsNCiAgICAgICAgICB0aXRsZTogJ0Vycm9yJywNCiAgICAgICAgICB2YXJpYW50OiAnZGFuZ2VyJywNCiAgICAgICAgICBhdXRvSGlkZURlbGF5OiAzMDAwDQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQoNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5wb3N0KCcvdHJhbnNhY3Rpb24nLCB7DQogICAgICAgICAgc2VydmljZV9jb2RlOiB0aGlzLnNlcnZpY2Uuc2VydmljZV9jb2RlLA0KICAgICAgICAgIGFtb3VudDogdGhpcy5hbW91bnQNCiAgICAgICAgfSk7DQoNCiAgICAgICAgaWYgKHJlcy5kYXRhICYmIHJlcy5kYXRhLnN1Y2Nlc3MpIHsNCiAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdQZW1iYXlhcmFuIHN1a3NlcycsIHsNCiAgICAgICAgICAgIHRpdGxlOiAnU3Vrc2VzJywNCiAgICAgICAgICAgIHZhcmlhbnQ6ICdzdWNjZXNzJywNCiAgICAgICAgICAgIGF1dG9IaWRlRGVsYXk6IDIwMDANCiAgICAgICAgICB9KTsNCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuJHJvdXRlci5wdXNoKCIvaGlzdG9yeSIpLCAyMDAwKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KHJlcy5kYXRhLm1lc3NhZ2UgfHwgJ0dhZ2FsIGJheWFyJywgew0KICAgICAgICAgICAgdGl0bGU6ICdFcnJvcicsDQogICAgICAgICAgICB2YXJpYW50OiAnZGFuZ2VyJywNCiAgICAgICAgICAgIGF1dG9IaWRlRGVsYXk6IDMwMDANCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdFcnJvciBzYWF0IHBlbWJheWFyYW4nLCB7DQogICAgICAgICAgdGl0bGU6ICdFcnJvcicsDQogICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicsDQogICAgICAgICAgYXV0b0hpZGVEZWxheTogMzAwMA0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Payment.vue"],"names":[],"mappings":";AA0DA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Payment.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-container>\r\n\r\n    <b-row class=\"mb-4\">\r\n      <b-col cols=\"12\" md=\"8\">\r\n        <div class=\"d-flex align-items-center\">\r\n          <img :src=\"userImage\" class=\"avatar-lg mr-3\" />\r\n          <div>\r\n            <h5 class=\"mb-1\">Selamat datang,</h5>\r\n            <h3 class=\"font-weight-bold\">{{ profile.first_name }} {{ profile.last_name }}</h3>\r\n          </div>\r\n        </div>\r\n      </b-col>\r\n\r\n      <b-col cols=\"12\" md=\"4\">\r\n        <b-card class=\"saldo-card text-white p-3 d-flex flex-column justify-content-between\">\r\n          <div>\r\n            <small>Saldo anda</small>\r\n            <h3 class=\"mb-0\">{{ showBalance ? balanceDisplay : 'Rp ••••••••' }}</h3>\r\n          </div>\r\n          <b-link class=\"text-white mt-2\" href=\"#\" @click.prevent=\"toggleBalance\">\r\n            {{ showBalance ? 'Sembunyikan' : 'Lihat Saldo' }}\r\n            <i :class=\"showBalance ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n          </b-link>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n\r\n    <b-card class=\"payment-card\">\r\n      <div v-if=\"service\">\r\n        <p class=\"mb-2 font-weight-bold\">Pembayaran</p>\r\n        <div class=\"d-flex align-items-center mb-3\">\r\n          <b-avatar :src=\"service.service_icon\" class=\"mr-2\"></b-avatar>\r\n          <strong>{{ service.service_name }}</strong>\r\n        </div>\r\n\r\n        <b-input-group class=\"mb-3\">\r\n          <b-input-group-prepend is-text>\r\n            <i class=\"fa-solid fa-money-bill-transfer\"></i>\r\n          </b-input-group-prepend>\r\n\r\n          <b-form-input v-model=\"amount\" placeholder=\"Masukkan nominal\" type=\"number\" />\r\n        </b-input-group>\r\n\r\n        <b-button block class=\"btn-bayar\" size=\"lg\" @click=\"doPayment\">\r\n          Bayar\r\n        </b-button>\r\n      </div>\r\n\r\n      <div v-else>\r\n        <p>Service belum dipilih. Kembali ke Home untuk memilih layanan.</p>\r\n        <b-button @click=\"$router.push('/home')\">Kembali ke Home</b-button>\r\n      </div>\r\n    </b-card>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport api from '../services/api';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      profile: {},\r\n      balance: 0,\r\n      showBalance: true,\r\n      service: null,\r\n      amount: null,\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    userImage() {\r\n      return this.profile.profile_image\r\n        ? this.profile.profile_image\r\n        : require('../assets/default-avatar.png')\r\n    },\r\n    balanceDisplay() {\r\n      return new Intl.NumberFormat('id-ID', {\r\n        style: 'currency',\r\n        currency: 'IDR'\r\n      }).format(this.balance || 0)\r\n    }\r\n  },\r\n\r\n  async created() {\r\n    const sid = this.$route.query.service_code;\r\n    try {\r\n      const [p, b] = await Promise.all([\r\n        api.get('/profile'),\r\n        api.get('/balance')\r\n      ]);\r\n      this.profile = p.data.data || {};\r\n      this.balance = (b.data && b.data.data.balance) ? b.data.data.balance : 0;\r\n\r\n      if (sid) {\r\n        const res = await api.get('/services');\r\n        const services = Array.isArray(res.data.data) ? res.data.data : [];\r\n        this.service = services.find(s => String(s.service_code) === String(sid));\r\n        this.amount = this.service.service_tariff;\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    toggleBalance() {\r\n      this.showBalance = !this.showBalance;\r\n    },\r\n\r\n    async doPayment() {\r\n      if (!this.service || !this.amount) {\r\n        this.$bvToast.toast('Masukkan nominal terlebih dahulu', {\r\n          title: 'Error',\r\n          variant: 'danger',\r\n          autoHideDelay: 3000\r\n        });\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const res = await api.post('/transaction', {\r\n          service_code: this.service.service_code,\r\n          amount: this.amount\r\n        });\r\n\r\n        if (res.data && res.data.success) {\r\n          this.$bvToast.toast('Pembayaran sukses', {\r\n            title: 'Sukses',\r\n            variant: 'success',\r\n            autoHideDelay: 2000\r\n          });\r\n          setTimeout(() => this.$router.push(\"/history\"), 2000);\r\n        } else {\r\n          this.$bvToast.toast(res.data.message || 'Gagal bayar', {\r\n            title: 'Error',\r\n            variant: 'danger',\r\n            autoHideDelay: 3000\r\n          });\r\n        }\r\n      } catch (e) {\r\n        this.$bvToast.toast('Error saat pembayaran', {\r\n          title: 'Error',\r\n          variant: 'danger',\r\n          autoHideDelay: 3000\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .saldo-card {\r\n    background-image: url('../assets/Background_Saldo.png');\r\n    border-radius: 16px;\r\n    background-repeat: no-repeat;\r\n    background-position: right;\r\n    min-height: 120px;\r\n  }\r\n  .avatar-lg {\r\n    width: 60px;\r\n    height: 60px;\r\n    border-radius: 50%;\r\n  }\r\n  .payment-card {\r\n    border-radius: 12px;\r\n    padding: 20px;\r\n  }\r\n  .btn-bayar {\r\n    background: #f44336;\r\n    border: none;\r\n    font-weight: bold;\r\n  }\r\n  .btn-bayar:hover {\r\n    background: #d32f2f;\r\n  }\r\n</style>\r\n"]}]}