{"remainingRequest":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Profile.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\src\\views\\Profile.vue","mtime":1757617856824},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1757611684910},{"path":"C:\\xampp\\htdocs\\his-ppob-vue2\\node_modules\\vue-loader\\lib\\index.js","mtime":1757611686384}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogIGltcG9ydCBhcGkgZnJvbSAnLi4vc2VydmljZXMvYXBpJzsNCiAgaW1wb3J0IHsNCiAgICBpbWFnZVNpemVVbmRlcg0KICB9IGZyb20gJy4uL3V0aWxzL3ZhbGlkYXRvcnMnOw0KICBleHBvcnQgZGVmYXVsdCB7DQogICAgZGF0YSgpIHsNCiAgICAgIHJldHVybiB7DQogICAgICAgIHByb2ZpbGU6IHt9LA0KICAgICAgICBmb3JtOiB7fSwNCiAgICAgICAgZWRpdGluZzogZmFsc2UsDQogICAgICAgIGltZ1ByZXZpZXc6IHJlcXVpcmUoJy4uL2Fzc2V0cy9kZWZhdWx0LWF2YXRhci5wbmcnKQ0KICAgICAgfQ0KICAgIH0sDQogICAgYXN5bmMgY3JlYXRlZCgpIHsNCiAgICAgIGF3YWl0IHRoaXMubG9hZFByb2ZpbGUoKTsNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgIGFzeW5jIGxvYWRQcm9maWxlKCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5nZXQoJy9wcm9maWxlJyk7DQogICAgICAgICAgdGhpcy5wcm9maWxlID0gcmVzLmRhdGEuZGF0YSB8fCB7fTsNCiAgICAgICAgICB0aGlzLmZvcm0gPSB7DQogICAgICAgICAgICBmaXJzdF9uYW1lOiB0aGlzLnByb2ZpbGUuZmlyc3RfbmFtZSwNCiAgICAgICAgICAgIGxhc3RfbmFtZTogdGhpcy5wcm9maWxlLmxhc3RfbmFtZSwNCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLnByb2ZpbGUuZW1haWwNCiAgICAgICAgICB9Ow0KICAgICAgICAgIGlmICh0aGlzLnByb2ZpbGUucHJvZmlsZV9pbWFnZSkgdGhpcy5pbWdQcmV2aWV3ID0gdGhpcy5wcm9maWxlLnByb2ZpbGVfaW1hZ2U7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOw0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgc3RhcnRFZGl0KCkgew0KICAgICAgICB0aGlzLmVkaXRpbmcgPSB0cnVlOw0KICAgICAgfSwNCiAgICAgIGNhbmNlbEVkaXQoKSB7DQogICAgICAgIHRoaXMuZWRpdGluZyA9IGZhbHNlOw0KICAgICAgICB0aGlzLmZvcm0gPSB7DQogICAgICAgICAgZmlyc3RfbmFtZTogdGhpcy5wcm9maWxlLmZpcnN0X25hbWUsDQogICAgICAgICAgbGFzdF9uYW1lOiB0aGlzLnByb2ZpbGUubGFzdF9uYW1lLA0KICAgICAgICAgIGVtYWlsOiB0aGlzLnByb2ZpbGUuZW1haWwNCiAgICAgICAgfTsNCiAgICAgIH0sDQogICAgICBwaWNrRmlsZSgpIHsNCiAgICAgICAgdGhpcy4kcmVmcy5maWxlLmNsaWNrKCk7DQogICAgICB9LA0KICAgICAgYXN5bmMgdXBsb2FkSW1hZ2UoZSkgew0KICAgICAgICBjb25zdCBmID0gZS50YXJnZXQuZmlsZXNbMF07DQogICAgICAgIGlmICghZikgcmV0dXJuOw0KICAgICAgICBpZiAoIWltYWdlU2l6ZVVuZGVyKGYsIDEwMCkpIHsNCiAgICAgICAgICByZXR1cm4gdGhpcy4kYnZUb2FzdC50b2FzdCgnVWt1cmFuIGZpbGUgbWVsZWJpaGkgMTAwIEtCJywgew0KICAgICAgICAgICAgdGl0bGU6ICdFcnJvcicsDQogICAgICAgICAgICB2YXJpYW50OiAnZGFuZ2VyJw0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGNvbnN0IGZkID0gbmV3IEZvcm1EYXRhKCk7DQogICAgICAgIGZkLmFwcGVuZCgnaW1hZ2UnLCBmKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBhcGkucG9zdCgnL3Byb2ZpbGUvaW1hZ2UnLCBmZCwgew0KICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnDQogICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQogICAgICAgICAgaWYgKHJlcy5kYXRhICYmIHJlcy5kYXRhLnN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoJ0ZvdG8gcHJvZmlsIGJlcmhhc2lsIGRpdXBkYXRlJywgew0KICAgICAgICAgICAgICB0aXRsZTogJ1N1a3NlcycsDQogICAgICAgICAgICAgIHZhcmlhbnQ6ICdzdWNjZXNzJw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmxvYWRQcm9maWxlKCk7DQogICAgICAgICAgfSBlbHNlIHRoaXMuJGJ2VG9hc3QudG9hc3QocmVzLmRhdGEubWVzc2FnZSB8fCAnR2FnYWwgdXBkYXRlIGZvdG8nLCB7DQogICAgICAgICAgICB0aXRsZTogJ0Vycm9yJywNCiAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInDQogICAgICAgICAgfSk7DQogICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgIC8vIHRoaXMuJGJ2VG9hc3QudG9hc3QoZXJyLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlIHx8ICdFcnJvciB1cGxvYWQnLHt0aXRsZTonRXJyb3InLHZhcmlhbnQ6J2Rhbmdlcid9KTsgDQogICAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdCgNCiAgICAgICAgICAgIChlcnIucmVzcG9uc2UgJiYgZXJyLnJlc3BvbnNlLmRhdGEgJiYgZXJyLnJlc3BvbnNlLmRhdGEubWVzc2FnZSkgfHwgJ0Vycm9yIHVwbG9hZCcsIHsNCiAgICAgICAgICAgICAgdGl0bGU6ICdFcnJvcicsDQogICAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgIGFzeW5jIHNhdmVQcm9maWxlKCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5wb3N0KCcvcHJvZmlsZS91cGRhdGUnLCB0aGlzLmZvcm0pOw0KICAgICAgICAgIGlmIChyZXMuZGF0YSAmJiByZXMuZGF0YS5zdWNjZXNzKSB7DQogICAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdQcm9maWxlIGRpc2ltcGFuJywgew0KICAgICAgICAgICAgICB0aXRsZTogJ1N1a3NlcycsDQogICAgICAgICAgICAgIHZhcmlhbnQ6ICdzdWNjZXNzJw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmVkaXRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMubG9hZFByb2ZpbGUoKTsNCiAgICAgICAgICB9IGVsc2UgdGhpcy4kYnZUb2FzdC50b2FzdChyZXMuZGF0YS5tZXNzYWdlIHx8ICdHYWdhbCBtZW55aW1wYW4nLCB7DQogICAgICAgICAgICB0aXRsZTogJ0Vycm9yJywNCiAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInDQogICAgICAgICAgfSk7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdFcnJvciBtZW55aW1wYW4gcHJvZmlsZScsIHsNCiAgICAgICAgICAgIHRpdGxlOiAnRXJyb3InLA0KICAgICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgIGxvZ291dCgpIHsNCiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2F1dGgvbG9nb3V0Jyk7DQogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvbG9naW4nKTsNCiAgICAgIH0NCiAgICB9DQogIH0NCg=="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";AAuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-row class=\"justify-content-center\">\r\n    <b-col cols=\"12\" md=\"8\">\r\n      <b-card class=\"card-elevated\">\r\n        <div class=\"d-flex\">\r\n          <div>\r\n            <img :src=\"imgPreview\" width=\"120\" height=\"120\" class=\"rounded\" style=\"object-fit:cover;cursor:pointer\" @click=\"pickFile\" />\r\n            <div class=\"mt-2 text-muted\" style=\"font-size:12px\">Klik gambar untuk ganti (max 100 KB)</div>\r\n          </div>\r\n          <div class=\"ml-4 flex-grow-1\">\r\n            <div v-if=\"!editing\">\r\n              <h5>{{profile.first_name}} {{profile.last_name}}</h5>\r\n              <div class=\"text-muted\">{{profile.email}}</div>\r\n              <b-button class=\"mt-3\" variant=\"outline-primary\" @click=\"startEdit\">Edit Profile</b-button>\r\n              <b-button class=\"mt-3 ml-2\" variant=\"danger\" @click=\"logout\">Logout</b-button>\r\n            </div>\r\n            <div v-else>\r\n              <b-form @submit.prevent=\"saveProfile\">\r\n                <b-form-group label=\"Nama Depan\">\r\n                  <b-form-input v-model=\"form.first_name\" required></b-form-input>\r\n                </b-form-group>\r\n                <b-form-group label=\"Nama Belakang\">\r\n                  <b-form-input v-model=\"form.last_name\" required></b-form-input>\r\n                </b-form-group>\r\n                <b-form-group label=\"Email\">\r\n                  <b-form-input v-model=\"form.email\" type=\"email\" required></b-form-input>\r\n                </b-form-group>\r\n                <b-button type=\"submit\" variant=\"success\">Simpan</b-button>\r\n                <b-button variant=\"secondary\" class=\"ml-2\" @click=\"cancelEdit\">Batalkan</b-button>\r\n              </b-form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <input ref=\"file\" type=\"file\" accept=\"image/*\" style=\"display:none\" @change=\"uploadImage\" />\r\n      </b-card>\r\n    </b-col>\r\n  </b-row>\r\n</template>\r\n<script>\r\n  import api from '../services/api';\r\n  import {\r\n    imageSizeUnder\r\n  } from '../utils/validators';\r\n  export default {\r\n    data() {\r\n      return {\r\n        profile: {},\r\n        form: {},\r\n        editing: false,\r\n        imgPreview: require('../assets/default-avatar.png')\r\n      }\r\n    },\r\n    async created() {\r\n      await this.loadProfile();\r\n    },\r\n    methods: {\r\n      async loadProfile() {\r\n        try {\r\n          const res = await api.get('/profile');\r\n          this.profile = res.data.data || {};\r\n          this.form = {\r\n            first_name: this.profile.first_name,\r\n            last_name: this.profile.last_name,\r\n            email: this.profile.email\r\n          };\r\n          if (this.profile.profile_image) this.imgPreview = this.profile.profile_image;\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      },\r\n      startEdit() {\r\n        this.editing = true;\r\n      },\r\n      cancelEdit() {\r\n        this.editing = false;\r\n        this.form = {\r\n          first_name: this.profile.first_name,\r\n          last_name: this.profile.last_name,\r\n          email: this.profile.email\r\n        };\r\n      },\r\n      pickFile() {\r\n        this.$refs.file.click();\r\n      },\r\n      async uploadImage(e) {\r\n        const f = e.target.files[0];\r\n        if (!f) return;\r\n        if (!imageSizeUnder(f, 100)) {\r\n          return this.$bvToast.toast('Ukuran file melebihi 100 KB', {\r\n            title: 'Error',\r\n            variant: 'danger'\r\n          });\r\n        }\r\n        const fd = new FormData();\r\n        fd.append('image', f);\r\n        try {\r\n          const res = await api.post('/profile/image', fd, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data'\r\n            }\r\n          });\r\n          if (res.data && res.data.success) {\r\n            this.$bvToast.toast('Foto profil berhasil diupdate', {\r\n              title: 'Sukses',\r\n              variant: 'success'\r\n            });\r\n            this.loadProfile();\r\n          } else this.$bvToast.toast(res.data.message || 'Gagal update foto', {\r\n            title: 'Error',\r\n            variant: 'danger'\r\n          });\r\n        } catch (err) {\r\n          // this.$bvToast.toast(err.response?.data?.message || 'Error upload',{title:'Error',variant:'danger'}); \r\n          this.$bvToast.toast(\r\n            (err.response && err.response.data && err.response.data.message) || 'Error upload', {\r\n              title: 'Error',\r\n              variant: 'danger'\r\n            });\r\n        }\r\n      },\r\n      async saveProfile() {\r\n        try {\r\n          const res = await api.post('/profile/update', this.form);\r\n          if (res.data && res.data.success) {\r\n            this.$bvToast.toast('Profile disimpan', {\r\n              title: 'Sukses',\r\n              variant: 'success'\r\n            });\r\n            this.editing = false;\r\n            this.loadProfile();\r\n          } else this.$bvToast.toast(res.data.message || 'Gagal menyimpan', {\r\n            title: 'Error',\r\n            variant: 'danger'\r\n          });\r\n        } catch (e) {\r\n          this.$bvToast.toast('Error menyimpan profile', {\r\n            title: 'Error',\r\n            variant: 'danger'\r\n          });\r\n        }\r\n      },\r\n      logout() {\r\n        this.$store.dispatch('auth/logout');\r\n        this.$router.push('/login');\r\n      }\r\n    }\r\n  }\r\n</script>"]}]}